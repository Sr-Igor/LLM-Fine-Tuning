# ============================================================================
# MLX Configuration for Apple Silicon (.env.mlx.example)
# ============================================================================
# Rename to envs/.env.mlx or source before running make mlx:*
# ============================================================================

# ----------------------------------------------------------------------------
# MODEL
# ----------------------------------------------------------------------------
# HuggingFace model name to use
# Supported models: Qwen 2.5 (3B, 7B, 14B, 32B), Llama 3.x, Mistral, etc.
APPLE_MODEL_NAME=mlx-community/Qwen2.5-14B-Instruct-4bit

# Maximum sequence length (tokens)
APPLE_MAX_SEQ_LENGTH=2048

# ----------------------------------------------------------------------------
# LORA (Low-Rank Adaptation)
# ----------------------------------------------------------------------------
APPLE_LORA_LAYERS=16
APPLE_LORA_RANK=16
APPLE_LORA_ALPHA=16
APPLE_LORA_DROPOUT=0.0

# ----------------------------------------------------------------------------
# TRAINING
# ----------------------------------------------------------------------------
# Batch size (Adjust according to available memory)
APPLE_BATCH_SIZE=2

# Learning rate
APPLE_LEARNING_RATE=1e-5

# Total number of training iterations
APPLE_NUM_ITERS=100

# Steps between evaluations on validation set
APPLE_STEPS_PER_EVAL=100

# Steps between progress reports
APPLE_STEPS_PER_REPORT=10

# Number of batches for validation
APPLE_VAL_BATCHES=25

# Save checkpoint every N steps
APPLE_SAVE_EVERY=100

# ----------------------------------------------------------------------------
# DATA
# ----------------------------------------------------------------------------
APPLE_TRAIN_DATA=data/train.jsonl
APPLE_VALID_DATA=data/valid.jsonl
APPLE_DATA_DIR=data

# ----------------------------------------------------------------------------
# OUTPUT
# ----------------------------------------------------------------------------
APPLE_ADAPTER_PATH=adapters_mlx
APPLE_FUSED_MODEL=models/llm_mlx_fused
APPLE_GGUF_OUTPUT=models/llm_mlx.gguf

# ----------------------------------------------------------------------------
# APPLE SILICON OPTIMIZATIONS
# ----------------------------------------------------------------------------
APPLE_USE_METAL=true
APPLE_GRAD_CHECKPOINT=true
APPLE_SEED=42
